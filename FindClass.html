

<html lang="en">
<head>
  <meta charset="utf-8">
  <title> TEMPTITLE - New User </title>
  <meta name="The Find Class Page" content="The HTML5 Herald">
  <meta name="Awn Duqoum" content="SitePoint">
</head>

<script>


function DeCodeClass ()
{
	var count = -1;
	var ClassID = document.getElementById("ClassIDLineEdit").value;
	ClassID = ClassID.replace(/\s+/g, '');
	
	while(true)
	{
		count ++;
		if(count == CodeName.length)
		{
			document.getElementById("ClassLabel").innerHTML = "Cannot Find Class";
			return;
		}
		if(ClassID.toLowerCase().indexOf(CodeName[count].toLowerCase().replace(/\s+/g, '')) != -1)
		{
			document.getElementById("ClassLabel").innerHTML = FullNames[count];
			document.getElementById("ClassLabel").innerHTML += ClassID.substr((ClassID.toLowerCase().indexOf(CodeName[count].toLowerCase().replace(/\s+/g, ''))),(ClassID.length));
			return;
		}
	}
}
function ValidateClass ()
{
	 var ClassID = document.getElementById("ClassIDLineEdit").value;
	 ClassID = ClassID.replace(/\s+/g, '');
	 
	 if(ClassID.length <= 3)
	 {
		document.getElementById("FirstLine").innerHTML = "Enter the class ID below <br> <p style='color:red'> <b> Not a proper class ID </b> </p>";
	 }
	 else
	 {
		var courseName = ClassID;
		var count = 0; 
		courseName = courseName.replace(/[0-9]/g, '');
		
		
		var link = "https://api.uwaterloo.ca/v2/courses/"+ courseName + ".json?key=b8e397c4182b835dd5e0d1306b176022";
			$.ajax({type: 'GET', url: link}).done(function(response) 
			{
			  if(response.meta.status == 200)
			  {
				var length = response.data.length;
				var count = 0;
				var classNumber = ClassID;
				classNumber = classNumber.substr((ClassID.toLowerCase().indexOf(courseName.toLowerCase().replace(/\s+/g, '')))+courseName.length,3);
				while(true)
				{
					if(response.data[count].catalog_number == classNumber)
					{
						var UWclass = '{"title": response.data[count].title ,"subject": response.data[count].subject,"catalog_number": response.data[count].catalog_number }';
						var Object = JSON.parse(UWclass);
						window.alert(UWclass);
						//&.ajax({type: 'POST', url: "kk", data:}) to pass shetttt later 
					}
					else 
						count ++;
					if (count == length)
						document.getElementById("FirstLine").innerHTML = "Enter the class ID below <br> <p style='color:red'> <b> Not a proper class ID </b> </p>";
				}
			  }
			  else
				document.getElementById("FirstLine").innerHTML = "Enter the class ID below <br> <p style='color:red'> <b> Not a proper class ID </b> </p>";
			}
			);
	 }
 }
</script>

<body>
<form onsubmit="ValidateClass(); return false;">
	<div>
	<p id="FirstLine"> Enter the class ID below </p>
	<br>
	<input type="Text" id="ClassIDLineEdit" oninput="DeCodeClass()" required> 
	<br>
	<label id = "ClassLabel"> </label>
	<br><br>
	<button type="submit" > Search </button>
	</div>	
	
</form>

</body>
</html>